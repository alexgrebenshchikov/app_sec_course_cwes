### CVE

https://github.com/advisories/GHSA-8m9f-c5p9-wqch

CVE-2022-25894 [не исправлено] Remote Code Execution (RCE) in the ExpressionContextImpl class via jexl.createExpression(expression).evaluate(context)

### CodeQL
Public методы, куда можно передать строку с подстроками вида ${some code} и этот код будет выполнен:

**class ExpressionContextImpl**

```public synchronized Object eval(ProcessInstance processInstance, String expression)```

```public synchronized Object eval(long processInstanceId, String expression)```

```public synchronized String evalString(ProcessInstance processInstance, String str)```


**class DefaultProcessService**

```public Object getProcessVariable(String key, long processInstanceId)```

```public Object getProcessVariable(String key, ProcessInstance processInstance)```

### POC

В директории cwe94_poc представлен пример программы, которая выполняет произвольный java код, передавая его в аргумент публичного метода библиотеки. Пример вывода:

![Пример вывода](image.png)

### Fix
Нужно убрать возможность через паблик методы выставлять context для JexlEngine (как раз то, что я сделал в секции POC), так как таким образом можно заставить JexlEngine выполнять произвольный код.

